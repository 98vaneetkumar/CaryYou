<div class="main-content">
  <section class="section">
    <div class="section-header">
      <h1>Order Details</h1>
      <div class="section-header-breadcrumb">
        <div class="breadcrumb-item active"><a href="/admin/dashboard">Dashboard</a></div>
        <div class="breadcrumb-item"><a href="/admin/order_list">Orders</a></div>
        <div class="breadcrumb-item">Order Details</div>
      </div>
    </div>
    <div class="section-body">
      <div class="card">
        <form action="" method="get" enctype="multipart/form-data">
          <!-- Back Button -->
          <div class="form-group text-left ml-3 mt-2">
            <a href="/admin/order_list" class="btn btn-info">
              <i class="fas fa-arrow-left"></i> Back</a>
          </div>
          <div class="row mt-sm-4 justify-content-center">
            <!-- Left Side - Order Info -->
            <div class="col-12 col-md-12 col-lg-4">
              <div class="card profile-widget">
                <div class="profile-widget-header text-center py-3">
                  <img
                    alt="Order By Image"
                    width="200"
                    height="200"
                    src="<%= order.orderBy?.image || 'https://avatar.iran.liara.run/public/boy?ordername=Ash' %>"
                    class="profile_img rounded-circle">
                </div>
              </div>
              <div class="card-body">
                <h4 class="text-center">Order Info</h4>
                <div class="form-group">
                  <label class="col-form-label">Order By</label>
                  <input type="text" value="<%= order.orderBy?.name || 'Pending' %>" class="form-control" disabled>
                </div>
                <div class="form-group">
                  <label class="col-form-label">Restaurant</label>
                  <input type="text" value="<%= order.restaurant?.name || 'Pending' %>" class="form-control" disabled>
                </div>
                <div class="form-group">
                  <label class="col-form-label">Item</label>
                  <input type="text" value="<%= order.item || 'N/A' %>" class="form-control" disabled>
                </div>
                <div class="form-group">
                  <label class="col-form-label">Price</label>
                  <input type="text" value="<%= order.price || 'N/A' %>" class="form-control" disabled>
                </div>
                <div class="form-group">
                  <label class="col-form-label">Status</label>
                  <input type="text" value="<%= getOrderStatus(order.status) %>" class="form-control" disabled>
                </div>
              </div>
            </div>

            <!-- Right Side - Rider & Delivery Details -->
            <div class="col-12 col-md-12 col-lg-7">
              <div class="card-body">
                <h4 class="text-center">Delivery Details</h4>
                <% if (order.status > 1) { %>
                  <!-- Rider Info -->
                  <div class="form-group">
                    <label class="col-form-label">Rider</label>
                    <input type="text" value="<%= order.rider?.name || 'Not Assigned' %>" class="form-control" disabled>
                  </div>
                  <div class="form-group">
                    <label class="col-form-label">Rider Tip</label>
                    <input type="text" value="<%= order.riderTip || 'No Tip' %>" class="form-control" disabled>
                  </div>
                  <!-- Pickup Details -->
                  <div class="form-group">
                    <label class="col-form-label">Pickup Time</label>
                    <input type="text" value="<%= formatDateTime(order.orderPickUpDate, order.orderPickUpTime) || 'Not Picked Up' %>" class="form-control" disabled>
                  </div>
                  <!-- Delivery Details -->
                  <div class="form-group">
                    <label class="col-form-label">Delivered Time</label>
                    <input type="text" value="<%= formatDateTime(order.orderDeliveredDate, order.orderDeliveredTime) || 'Not Delivered' %>" class="form-control" disabled>
                  </div>
                <% } else { %>
                  <p class="text-center">Delivery details will be available once the rider is assigned and updates are provided.</p>
                <% } %>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>
</div>

<script>
  function getOrderStatus(status) {
    const statuses = {
      1: 'Pending',
      2: 'Success',
      3: 'Rejected',
      4: 'Ongoing',
      5: 'Returned'
    };
    return statuses[status] || 'Unknown';
  }

  function formatDateTime(date, time) {
    if (!date || !time) return null;
    return `${new Date(date).toLocaleDateString()} ${new Date(time).toLocaleTimeString()}`;
  }
</script>

<style>
  .profile_img {
    object-fit: cover;
  }

  .form-group {
    margin-bottom: 15px;
  }
</style>
